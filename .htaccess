# ------------------------------------
# Enable Rewrite Engine
# ------------------------------------
RewriteEngine On
RewriteBase /
 
# ------------------------------------
# Force HTTPS
# ------------------------------------
RewriteCond %{HTTPS} !=on
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
 
# ------------------------------------
# Security Headers
# ------------------------------------
Header always set X-Frame-Options "DENY"
Header always set X-Content-Type-Options "nosniff"
Header always set X-XSS-Protection "1; mode=block"
Header always set Referrer-Policy "no-referrer-when-downgrade"
Header always set Content-Security-Policy "default-src 'self' https: data: blob:; img-src 'self' https: data:; script-src 'self' https: 'unsafe-inline'; style-src 'self' https: 'unsafe-inline';"
 
# ------------------------------------
# Disable Directory Browsing
# ------------------------------------
Options -Indexes
 RewriteEngine On
RewriteRule ^stripe-webhook\.php$ - [L]
# ------------------------------------
# Remove .php from URLs (external redirect)
# ------------------------------------
RewriteCond %{THE_REQUEST} \s/+(.+?)\.php[\s?]
RewriteRule ^ %1 [R=301,L]
 
# ------------------------------------
# Serve existing files/folders normally
# ------------------------------------
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]
 
# ------------------------------------
# Map clean URLs to .php internally
# ------------------------------------
RewriteCond %{REQUEST_FILENAME}.php -f
RewriteRule ^(.+)$ $1.php [L,QSA]
 
# ------------------------------------
# Default fallback â†’ index.php
# ------------------------------------
RewriteRule ^ index.php [QSA,L]
 # ===============================================
# ðŸš« Prevent redirect for Stripe webhook
# ===============================================

